# âœ… Ø³ÛŒØ³ØªÙ… Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ ØªÚ©Ø±Ø§Ø±ÛŒ (Anti-Duplicate System)

## ğŸ¯ Ù…Ø´Ú©Ù„ÛŒ Ú©Ù‡ Ø­Ù„ Ø´Ø¯:

Ø¯Ø± Ù„ÛŒØ³ØªÛŒ Ø§Ø² 100 usernameØŒ Ø§Ú¯Ø± task Ù‚Ø·Ø¹ Ø´ÙˆØ¯ ÛŒØ§ Ø®Ø·Ø§ Ø±Ø® Ø¯Ù‡Ø¯ØŒ Ù†Ø¨Ø§ÛŒØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¨Ù‡ username Ù‡Ø§ÛŒÛŒ Ú©Ù‡ Ù‚Ø¨Ù„Ø§Ù‹ Ù¾ÛŒØ§Ù… Ú¯Ø±ÙØªÙ†Ø¯ØŒ Ù¾ÛŒØ§Ù… Ø§Ø±Ø³Ø§Ù„ Ø´ÙˆØ¯.

---

## âœ… Ø±Ø§Ù‡â€ŒØ­Ù„: Ø³ÛŒØ³ØªÙ… Checkpoint

### ğŸ“‹ Ù†Ø­ÙˆÙ‡ Ú©Ø§Ø±:

#### 1. **ÙˆÙ‚ØªÛŒ Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯:**
```
âœ… Ù¾ÛŒØ§Ù… Ø¨Ù‡ @username1 Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯
â†’ @username1 Ø¯Ø± ÙØ§ÛŒÙ„ checkpoint Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
â†’ Ø§Ø² Ù„ÛŒØ³Øª task Ø®Ø· Ù…ÛŒâ€ŒØ®ÙˆØ±Ø¯
```

#### 2. **ÙØ§ÛŒÙ„ Checkpoint:**
```json
{
  "task_id": "task_20251116_045030",
  "sent_usernames": [
    "username1",
    "username2",
    "username3"
  ],
  "total_sent": 3,
  "total_failed": 1,
  "timestamp": "2025-11-16T04:52:15"
}
```

#### 3. **ÙˆÙ‚ØªÛŒ task Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø¬Ø±Ø§ Ù…ÛŒâ€ŒØ´ÙˆØ¯:**
```
ğŸ“‚ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ checkpoint...
âœ… 3 username Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡
â­ï¸ username1, username2, username3 skip Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
â†’ ÙÙ‚Ø· username Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ process Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
```

---

## ğŸ”’ ØªØ¶Ù…ÛŒÙ†â€ŒÙ‡Ø§ÛŒ Ø³ÛŒØ³ØªÙ…:

### âœ… Ù‡ÛŒÚ† username Ø¯ÙˆØ¨Ø§Ø± Ù¾ÛŒØ§Ù… Ù†Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
- Ù‡Ø± username ÙÙ‚Ø· ÛŒÚ© Ø¨Ø§Ø± mark Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ØŒ double-check Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø¨Ø¹Ø¯ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ Ù…ÙˆÙÙ‚ØŒ ÙÙˆØ±Ø§Ù‹ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯

### âœ… Ù…Ø­Ø§ÙØ¸Øª Ø¯Ø± Ø¨Ø±Ø§Ø¨Ø± Ù‚Ø·Ø¹ Ø´Ø¯Ù†
- Ù‡Ø± Ø§Ø±Ø³Ø§Ù„ Ù…ÙˆÙÙ‚ â†’ ÙÙˆØ±Ø§Ù‹ checkpoint Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø§Ú¯Ø± task Ù‚Ø·Ø¹ Ø´Ø¯ â†’ ÙˆÙ‚ØªÛŒ restart Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ø§Ø² Ø¬Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø§Ø¯Ø§Ù…Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯

### âœ… Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ username
```python
@Username1 â†’ username1
Username1 â†’ username1
USERNAME1 â†’ username1
```
Ù‡Ù…Ù‡ Ø¨Ù‡ ÛŒÚ© Ø´Ú©Ù„ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯

---

## ğŸ“Š Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÛŒ:

### Task Ø§ÙˆÙ„:
```
100 username Ø¯Ø§Ø±ÛŒÙ…
â†’ 50 ØªØ§ Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
â†’ Ø®Ø·Ø§ Ø±Ø® Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ùˆ task Ù‚Ø·Ø¹ Ù…ÛŒâ€ŒØ´ÙˆØ¯
â†’ checkpoint: 50 username Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
```

### Task Ø¯ÙˆÙ… (restart):
```
100 username Ù…ÛŒâ€ŒØ¯Ù‡ÛŒÙ… Ø¨Ù‡ Ø±Ø¨Ø§Øª
â†’ Ø±Ø¨Ø§Øª checkpoint Ø±Ø§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù†Ø¯
â†’ 50 username Ù‚Ø¨Ù„ÛŒ Ø±Ø§ skip Ù…ÛŒâ€ŒÚ©Ù†Ø¯
â†’ ÙÙ‚Ø· 50 username Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡ Ø±Ø§ process Ù…ÛŒâ€ŒÚ©Ù†Ø¯
âœ… Ù†ØªÛŒØ¬Ù‡: Ù‡Ù…Ù‡ 100 username ÙÙ‚Ø· ÛŒÚ© Ø¨Ø§Ø± Ù¾ÛŒØ§Ù… Ú¯Ø±ÙØªÙ†Ø¯
```

---

## ğŸ› ï¸ Ø§Ø³ØªÙØ§Ø¯Ù‡:

### Ø¯Ø± Ú©Ø¯:

```python
from src.smart_sender import SmartBulkSender

# Ø§ÛŒØ¬Ø§Ø¯ sender Ø¨Ø§ task_id
sender = SmartBulkSender(
    accounts=accounts,
    usernames=usernames,
    message="Ø³Ù„Ø§Ù…",
    max_per_account=4,
    task_id="my_campaign_001"  # âœ… Ø´Ù†Ø§Ø³Ù‡ ÛŒÚ©ØªØ§
)

# Ø§Ø±Ø³Ø§Ù„
await sender.send_all()

# (Ø§Ø®ØªÛŒØ§Ø±ÛŒ) Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ checkpoint Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªÙ…Ø§Ù…
sender.cleanup()
```

### Task ID:
- Ø§Ú¯Ø± `task_id` Ù†Ø¯Ù‡ÛŒØ¯ â†’ Ø®ÙˆØ¯Ú©Ø§Ø± generate Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø§Ú¯Ø± `task_id` ÛŒÚ©Ø³Ø§Ù† Ø¨Ø¯Ù‡ÛŒØ¯ â†’ Ø§Ø² Ù‡Ù…Ø§Ù† checkpoint Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø¨Ø±Ø§ÛŒ campaign Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù â†’ task_id Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯

---

## ğŸ“ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Checkpoint:

```
task_checkpoint_my_campaign_001.json
task_checkpoint_task_20251116_045030.json
```

- Ø¯Ø± Ù‡Ù…Ø§Ù† Ù¾ÙˆØ´Ù‡ Ø±Ø¨Ø§Øª Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªÙ…Ø§Ù… task Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ (Ø¨Ø§ `sender.cleanup()`)
- ÛŒØ§ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ø± Ø¢ÛŒÙ†Ø¯Ù‡

---

## ğŸ¯ Ù…Ø²Ø§ÛŒØ§:

1. âœ… **Ø§Ù…Ù†ÛŒØª Ú©Ø§Ù…Ù„:** Ù‡ÛŒÚ† username Ø¯ÙˆØ¨Ø§Ø± Ù¾ÛŒØ§Ù… Ù†Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
2. âœ… **Ø§Ø¯Ø§Ù…Ù‡ Ø§Ø² Ø¬Ø§ÛŒ Ù‚Ø·Ø¹ Ø´Ø¯Ù‡:** Ø§Ú¯Ø± task fail Ø´Ø¯ØŒ Ø§Ø² Ù‡Ù…Ø§Ù† Ø¬Ø§ Ø§Ø¯Ø§Ù…Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
3. âœ… **Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§:** username Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ skip Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
4. âœ… **Ú¯Ø²Ø§Ø±Ø´ Ø¯Ù‚ÛŒÙ‚:** Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø¨ÛŒÙ†ÛŒØ¯ Ú†Ù†Ø¯ ØªØ§ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯Ù‡
5. âœ… **Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ±:** Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ task_id Ø±Ø§ Ø®ÙˆØ¯ØªØ§Ù† ØªØ¹ÛŒÛŒÙ† Ú©Ù†ÛŒØ¯

---

## ğŸ” Ù„Ø§Ú¯â€ŒÙ‡Ø§:

```
â„¹ï¸ No checkpoint found, starting fresh
âœ… Checkpoint loaded: 50 usernames already sent
âš ï¸ 50 usernames already sent, skipping them
â­ï¸ Skipping @username1 (already sent in previous task)
âœ… Marked as sent: @username2
ğŸ’¾ Checkpoint saved: 51 usernames
ğŸ—‘ï¸ Checkpoint file removed: task_checkpoint_my_campaign_001.json
```

---

## âš™ï¸ Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:

ÙØ§ÛŒÙ„: `src/smart_sender.py`

- `_load_checkpoint()` - Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² ÙØ§ÛŒÙ„
- `_save_checkpoint()` - Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± ÙØ§ÛŒÙ„
- `_mark_as_sent()` - mark Ú©Ø±Ø¯Ù† username
- `_normalize_username()` - Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ
- `cleanup()` - Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ checkpoint

---

## ğŸ“ Ù†Ú©Ø§Øª Ù…Ù‡Ù…:

1. **ÙÙ‚Ø· SUCCESS mark Ù…ÛŒâ€ŒØ´ÙˆØ¯:**
   - Ø§Ú¯Ø± Ù¾ÛŒØ§Ù… Ù…ÙˆÙÙ‚ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯ â†’ mark Ù…ÛŒâ€ŒØ´ÙˆØ¯
   - Ø§Ú¯Ø± NOT_FOUND Ø¨ÙˆØ¯ â†’ mark Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ (Ù†ÛŒØ§Ø²ÛŒ Ù†ÛŒØ³Øª)
   - Ø§Ú¯Ø± FAILED Ø¨ÙˆØ¯ â†’ mark Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ (Ø¨Ø§ÛŒØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ø´ÙˆØ¯)

2. **Double-check:**
   - Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ØŒ Ú†Ú© Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ú©Ù‡ mark Ù†Ø¨Ø§Ø´Ø¯
   - Ø¨Ø¹Ø¯ Ø§Ø² Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ checkpointØŒ filter Ù…ÛŒâ€ŒØ´ÙˆØ¯

3. **Thread-safe:**
   - Ù‡Ø± Ø§Ø±Ø³Ø§Ù„ ÙÙˆØ±Ø§Ù‹ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
   - checkpoint Ø¨Ø¹Ø¯ Ø§Ø² Ù‡Ø± SUCCESS Ø¨Ù‡â€ŒØ±ÙˆØ² Ù…ÛŒâ€ŒØ´ÙˆØ¯

